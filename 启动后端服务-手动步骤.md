# ğŸš€ å¯åŠ¨åç«¯æœåŠ¡ - æ‰‹åŠ¨æ­¥éª¤

## ğŸ“‹ å½“å‰çŠ¶æ€

- âœ… åç«¯ä»£ç å·²éƒ¨ç½²åˆ°æœåŠ¡å™¨ï¼š`/var/www/sgc_website/server`
- âœ… Nginx åå‘ä»£ç†å·²é…ç½®
- âš ï¸ **éœ€è¦å®‰è£… Node.js å¹¶å¯åŠ¨åç«¯æœåŠ¡**

## ğŸ”§ æ‰‹åŠ¨å®‰è£…æ­¥éª¤

### æ­¥éª¤ 1: SSH è¿æ¥åˆ°æœåŠ¡å™¨

```bash
ssh root@47.106.73.160
```

è¾“å…¥å¯†ç ï¼š`Botool=300739`

### æ­¥éª¤ 2: å®‰è£… Node.js

æœåŠ¡å™¨ä½¿ç”¨çš„æ˜¯ CentOS/RHEL ç³»ç»Ÿï¼ˆä½¿ç”¨ dnfï¼‰ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
# å®‰è£… NodeSource ä»“åº“
curl -fsSL https://rpm.nodesource.com/setup_20.x | bash -

# å®‰è£… Node.js
dnf install -y nodejs

# éªŒè¯å®‰è£…
node --version
npm --version
```

### æ­¥éª¤ 3: è¿›å…¥åç«¯ç›®å½•å¹¶å®‰è£…ä¾èµ–

```bash
cd /var/www/sgc_website/server

# å®‰è£…ä¾èµ–
npm install --production

# åˆ›å»ºå¿…è¦çš„ç›®å½•
mkdir -p data uploads
```

### æ­¥éª¤ 4: å®‰è£… PM2ï¼ˆæ¨èï¼Œç”¨äºè¿›ç¨‹ç®¡ç†ï¼‰

```bash
npm install -g pm2
```

### æ­¥éª¤ 5: å¯åŠ¨åç«¯æœåŠ¡

**æ–¹å¼ 1: ä½¿ç”¨ PM2ï¼ˆæ¨èï¼‰**

```bash
# å¯åŠ¨æœåŠ¡
pm2 start server.js --name sgc-backend

# ä¿å­˜è¿›ç¨‹åˆ—è¡¨ï¼ˆå¼€æœºè‡ªå¯ï¼‰
pm2 save

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
pm2 list

# æŸ¥çœ‹æ—¥å¿—
pm2 logs sgc-backend
```

**æ–¹å¼ 2: ç›´æ¥å¯åŠ¨ï¼ˆä¸´æ—¶ï¼‰**

```bash
# åå°è¿è¡Œ
nohup node server.js > /tmp/sgc-backend.log 2>&1 &

# æŸ¥çœ‹æ—¥å¿—
tail -f /tmp/sgc-backend.log
```

### æ­¥éª¤ 6: éªŒè¯æœåŠ¡

```bash
# æµ‹è¯•åç«¯æœåŠ¡
curl http://localhost:3001/health
# åº”è¯¥è¿”å›: {"status":"ok","message":"Server is running"}

# æµ‹è¯• API ä»£ç†
curl http://localhost/api/experts
# åº”è¯¥è¿”å›ä¸“å®¶åˆ—è¡¨æ•°æ®ï¼ˆJSON æ ¼å¼ï¼‰
```

## âœ… éªŒè¯éƒ¨ç½²

åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š
- **ç®¡ç†åå°**: http://47.106.73.160/admin
- **API æµ‹è¯•**: http://47.106.73.160/api/experts

## ğŸ“ PM2 å¸¸ç”¨å‘½ä»¤

```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡
pm2 list

# æŸ¥çœ‹æ—¥å¿—
pm2 logs sgc-backend

# é‡å¯æœåŠ¡
pm2 restart sgc-backend

# åœæ­¢æœåŠ¡
pm2 stop sgc-backend

# åˆ é™¤æœåŠ¡
pm2 delete sgc-backend

# æŸ¥çœ‹æœåŠ¡è¯¦æƒ…
pm2 info sgc-backend

# ç›‘æ§æœåŠ¡
pm2 monit
```

## ğŸ” æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: Node.js å®‰è£…å¤±è´¥

å¦‚æœ NodeSource å®‰è£…å¤±è´¥ï¼Œå¯ä»¥å°è¯•ï¼š

```bash
# ä½¿ç”¨ EPEL ä»“åº“
dnf install -y epel-release
dnf install -y nodejs npm
```

### é—®é¢˜ 2: ç«¯å£è¢«å ç”¨

```bash
# æ£€æŸ¥ç«¯å£å ç”¨
lsof -i :3001

# æˆ–
netstat -tulpn | grep 3001
```

### é—®é¢˜ 3: æœåŠ¡å¯åŠ¨å¤±è´¥

```bash
# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
pm2 logs sgc-backend --err

# æˆ–ç›´æ¥è¿è¡ŒæŸ¥çœ‹é”™è¯¯
cd /var/www/sgc_website/server
node server.js
```

### é—®é¢˜ 4: API è¿”å› 502

1. æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦è¿è¡Œï¼š`pm2 list` æˆ– `ps aux | grep node`
2. æ£€æŸ¥åç«¯æ—¥å¿—ï¼š`pm2 logs sgc-backend`
3. æ£€æŸ¥ Nginx æ—¥å¿—ï¼š`tail -f /var/log/nginx/sgc_website_error.log`

## ğŸ¯ ä¸€é”®æ‰§è¡Œè„šæœ¬ï¼ˆå¯é€‰ï¼‰

å¦‚æœä½ æƒ³ä¸€æ¬¡æ€§æ‰§è¡Œæ‰€æœ‰å‘½ä»¤ï¼Œå¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œï¼š

```bash
# å®‰è£… Node.js
curl -fsSL https://rpm.nodesource.com/setup_20.x | bash -
dnf install -y nodejs

# å®‰è£… PM2
npm install -g pm2

# è¿›å…¥åç«¯ç›®å½•
cd /var/www/sgc_website/server

# å®‰è£…ä¾èµ–
npm install --production

# åˆ›å»ºç›®å½•
mkdir -p data uploads

# å¯åŠ¨æœåŠ¡
pm2 start server.js --name sgc-backend
pm2 save

# éªŒè¯
sleep 2
curl http://localhost:3001/health
```

---

**å®Œæˆè¿™äº›æ­¥éª¤åï¼Œåç«¯æœåŠ¡å°±ä¼šå¯åŠ¨ï¼Œç®¡ç†åå°å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ï¼** ğŸ‰

