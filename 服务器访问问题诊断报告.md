# 服务器访问问题诊断报告

## 诊断时间
2025-12-05

## 服务器信息
- **IP 地址**: 47.106.73.160
- **服务器状态**: 正常运行

## 诊断结果

### ✅ 服务器端配置正常

1. **Nginx 服务状态**: ✅ 运行中
   ```
   Active: active (running)
   ```

2. **端口监听**: ✅ 正常
   ```
   LISTEN 0.0.0.0:80 (IPv4)
   LISTEN [::]:80 (IPv6)
   ```

3. **网站文件**: ✅ 存在且完整
   ```
   /var/www/sgc_website/dist/index.html 存在
   文件总数: 388 个文件
   ```

4. **Nginx 配置**: ✅ 正确
   - server_name: 47.106.73.160
   - root: /var/www/sgc_website/dist
   - location / 配置正确

5. **防火墙规则**: ✅ 已配置
   ```
   ACCEPT tcp -- 0.0.0.0/0 0.0.0.0/0 tcp dpt:80
   ```

6. **SELinux**: ✅ 已禁用

7. **服务器本地访问**: ✅ 正常
   ```
   HTTP/1.1 200 OK
   ```

### ❌ 外网访问问题

**测试结果**: 外网无法访问
```
curl http://47.106.73.160
结果: 连接超时/连接被重置
```

## 问题原因

**云服务器安全组未开放 80 端口**

外网请求无法到达服务器，说明云服务器的安全组（防火墙）阻止了 80 端口的入站流量。

## 解决方案

### 阿里云 ECS 安全组配置

1. **登录阿里云控制台**
   - 访问: https://ecs.console.aliyun.com

2. **找到服务器实例**
   - 进入"云服务器 ECS" → "实例"
   - 找到 IP 为 `47.106.73.160` 的实例

3. **配置安全组**
   - 点击实例名称进入详情
   - 点击"安全组"标签页
   - 点击"配置规则"

4. **添加入站规则**
   - 点击"添加安全组规则"
   - 配置如下：
     ```
     规则方向: 入方向
     授权策略: 允许
     优先级: 1
     协议类型: 自定义 TCP
     端口范围: 80/80
     授权对象: 0.0.0.0/0
     描述: HTTP 访问
     ```
   - 点击"保存"

### 腾讯云 CVM 安全组配置

1. **登录腾讯云控制台**
   - 访问: https://console.cloud.tencent.com/cvm

2. **找到服务器实例**
   - 进入"云服务器" → "实例"
   - 找到 IP 为 `47.106.73.160` 的实例

3. **配置安全组**
   - 点击实例 ID 进入详情
   - 点击"安全组"标签页
   - 点击"修改规则"

4. **添加入站规则**
   - 点击"添加规则"
   - 配置如下：
     ```
     类型: 自定义
     来源: 0.0.0.0/0
     协议端口: TCP:80
     策略: 允许
     备注: HTTP 访问
     ```
   - 点击"完成"

### 其他云服务商

如果使用的是其他云服务商（如华为云、AWS、Azure 等），请：
1. 登录对应云服务商控制台
2. 找到服务器的安全组/防火墙配置
3. 添加入站规则：允许 TCP 协议 80 端口，来源 0.0.0.0/0

## 验证步骤

配置安全组后：

1. **等待 1-2 分钟**（规则生效需要时间）

2. **测试访问**
   ```bash
   curl -I http://47.106.73.160
   ```
   应该返回：
   ```
   HTTP/1.1 200 OK
   ```

3. **浏览器访问**
   在浏览器中访问：
   ```
   http://47.106.73.160
   ```
   应该能看到网站首页

## 关于"内网无法访问"

如果您说的"内网"是指：
- **同一局域网内的其他机器**: 需要确保这些机器和服务器在同一网络，且网络策略允许访问
- **通过内网 IP 访问**: 请使用服务器的内网 IP（如果有），而不是公网 IP

## 总结

**服务器端配置完全正常，问题在于云服务器安全组未开放 80 端口。**

**请按照上述步骤在云服务器控制台配置安全组规则，开放 80 端口后即可正常访问。**

